import{j as e,T as Q,i as M,A as Z,k as q,r as ee}from"./index-UoUPk7yu.js";import{r as i}from"./react-vendor-Dn3TfeyG.js";import{y as se,f as S,e as k,D as O,S as te,X as A,G as L,w as ae,B as D,l as $,r as re,E as le,z as ne,g as ie,A as T,J as oe,R as de,K as ce}from"./icons-B-AdWDVm.js";import{I as me}from"./IndustrySelect-BmlZS-NJ.js";import{D as xe}from"./DomainInput-Cg7_OB64.js";import"./charts-DCrIq4dL.js";import"./supabase-CDMW_bd0.js";const pe=({pendingCount:s,approvedToday:n,rejectedCount:p,totalCount:h})=>{const c=[{label:"Pending Requests",value:s,icon:se,color:"yellow",bgColor:"bg-yellow-100",iconColor:"text-yellow-600",borderColor:"border-yellow-200"},{label:"Approved Today",value:n,icon:S,color:"green",bgColor:"bg-green-100",iconColor:"text-green-600",borderColor:"border-green-200"},{label:"Rejected",value:p,icon:k,color:"red",bgColor:"bg-red-100",iconColor:"text-red-600",borderColor:"border-red-200"},{label:"Total Requests",value:h,icon:O,color:"blue",bgColor:"bg-blue-100",iconColor:"text-blue-600",borderColor:"border-blue-200"}];return e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4 mb-6",children:c.map((r,l)=>e.jsx("div",{className:`bg-white rounded-lg p-4 border ${r.borderColor} shadow-sm hover:shadow-md transition-shadow duration-200`,children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600 mb-1",children:r.label}),e.jsx("p",{className:"text-3xl font-bold text-gray-900",children:r.value})]}),e.jsx("div",{className:`${r.bgColor} rounded-full p-3`,children:e.jsx(r.icon,{className:`w-6 h-6 ${r.iconColor}`})})]})},l))})},he=({statusFilter:s,setStatusFilter:n,industryFilter:p,setIndustryFilter:h,searchQuery:c,setSearchQuery:r,industries:l})=>{const g=s!=="all"||p!=="all"||c!=="",m=()=>{n("all"),h("all"),r("")};return e.jsx("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-4 mb-6",children:e.jsxs("div",{className:"flex flex-col lg:flex-row lg:items-center lg:space-x-4 space-y-4 lg:space-y-0",children:[e.jsxs("div",{className:"flex-1 relative",children:[e.jsx(te,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400"}),e.jsx("input",{type:"text",placeholder:"Search company name...",value:c,onChange:o=>r(o.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),e.jsx("div",{className:"w-full lg:w-48",children:e.jsxs("select",{value:s,onChange:o=>n(o.target.value),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[e.jsx("option",{value:"all",children:"All Status"}),e.jsx("option",{value:"pending",children:"Pending"}),e.jsx("option",{value:"approved",children:"Approved"}),e.jsx("option",{value:"rejected",children:"Rejected"})]})}),e.jsx("div",{className:"w-full lg:w-48",children:e.jsxs("select",{value:p,onChange:o=>h(o.target.value),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[e.jsx("option",{value:"all",children:"All Industries"}),l.map(o=>e.jsx("option",{value:o,children:o},o))]})}),g&&e.jsxs("button",{onClick:m,className:"flex items-center space-x-2 px-4 py-2 text-gray-600 hover:text-gray-900 hover:bg-gray-100 rounded-lg transition-colors duration-200",children:[e.jsx(A,{className:"w-4 h-4"}),e.jsx("span",{className:"whitespace-nowrap",children:"Clear Filters"})]})]})})},ge=({request:s,onViewDetails:n,onApprove:p,onReject:h})=>{const c=l=>{const g={pending:{color:"bg-yellow-100 text-yellow-800 border-yellow-200",label:"Pending"},approved:{color:"bg-green-100 text-green-800 border-green-200",label:"Approved"},rejected:{color:"bg-red-100 text-red-800 border-red-200",label:"Rejected"}},m=g[l]||g.pending;return e.jsx("span",{className:`px-3 py-1 rounded-full text-xs font-medium border ${m.color}`,children:m.label})},r=l=>{const g=new Date(l),o=Math.abs(new Date().getTime()-g.getTime()),b=Math.ceil(o/(1e3*60*60*24));return b===0?"Today":b===1?"Yesterday":b<7?`${b} days ago`:b<30?`${Math.floor(b/7)} weeks ago`:g.toLocaleDateString()};return e.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-6 hover:shadow-md transition-shadow duration-200",children:[e.jsx("div",{className:"flex items-start justify-between mb-4",children:e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center space-x-3 mb-2",children:[e.jsx("h3",{className:"text-lg font-bold text-gray-900",children:s.company_name}),c(s.status)]}),e.jsxs("a",{href:s.company_website,target:"_blank",rel:"noopener noreferrer",className:"flex items-center space-x-1 text-sm text-blue-600 hover:text-blue-800",children:[e.jsx(L,{className:"w-4 h-4"}),e.jsx("span",{children:s.company_website}),e.jsx(ae,{className:"w-3 h-3"})]})]})}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 mb-4",children:[e.jsxs("div",{className:"flex items-center space-x-2 text-sm text-gray-600",children:[e.jsx(D,{className:"w-4 h-4"}),e.jsx("span",{children:s.industry})]}),e.jsxs("div",{className:"flex items-center space-x-2 text-sm text-gray-600",children:[e.jsx($,{className:"w-4 h-4"}),e.jsx("span",{children:s.company_size})]}),e.jsxs("div",{className:"flex items-center space-x-2 text-sm text-gray-600",children:[e.jsx(re,{className:"w-4 h-4"}),e.jsx("span",{children:r(s.created_at)})]}),e.jsxs("div",{className:"text-sm text-gray-600",children:[e.jsx("span",{className:"font-medium",children:s.email_domains.length})," email domain",s.email_domains.length!==1?"s":""]})]}),s.justification&&e.jsxs("div",{className:"mb-4 p-3 bg-gray-50 rounded-lg",children:[e.jsx("p",{className:"text-xs text-gray-500 mb-1",children:"Justification:"}),e.jsx("p",{className:"text-sm text-gray-700 line-clamp-2",children:s.justification})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsxs("button",{onClick:()=>n(s),className:"flex-1 flex items-center justify-center space-x-2 px-4 py-2 border border-gray-300 rounded-lg text-gray-700 hover:bg-gray-50 transition-colors duration-200",children:[e.jsx(le,{className:"w-4 h-4"}),e.jsx("span",{children:"View Details"})]}),s.status==="pending"&&e.jsxs(e.Fragment,{children:[e.jsxs("button",{onClick:()=>p(s),className:"flex-1 flex items-center justify-center space-x-2 px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors duration-200",children:[e.jsx(S,{className:"w-4 h-4"}),e.jsx("span",{children:"Approve"})]}),e.jsxs("button",{onClick:()=>h(s),className:"flex-1 flex items-center justify-center space-x-2 px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 transition-colors duration-200",children:[e.jsx(k,{className:"w-4 h-4"}),e.jsx("span",{children:"Reject"})]})]})]}),s.status!=="pending"&&s.reviewed_at&&e.jsx("div",{className:"mt-4 pt-4 border-t border-gray-200",children:e.jsxs("div",{className:"flex items-center justify-between text-xs text-gray-500",children:[e.jsxs("span",{children:["Reviewed ",r(s.reviewed_at)]}),s.reviewed_by&&e.jsxs("span",{children:["by ",s.reviewed_by]})]})})]})},be=({request:s,isOpen:n,onClose:p})=>{if(!n||!s)return null;const h=r=>new Date(r).toLocaleString("en-US",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"}),c=r=>{const l={pending:"bg-yellow-100 text-yellow-800 border-yellow-200",approved:"bg-green-100 text-green-800 border-green-200",rejected:"bg-red-100 text-red-800 border-red-200"};return l[r]||l.pending};return e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-4",children:e.jsxs("div",{className:"bg-white rounded-lg max-w-3xl w-full max-h-[90vh] overflow-y-auto",children:[e.jsxs("div",{className:"sticky top-0 bg-white border-b border-gray-200 px-6 py-4 flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-1",children:s.company_name}),e.jsx("span",{className:`inline-block px-3 py-1 rounded-full text-xs font-medium border ${c(s.status)}`,children:s.status.charAt(0).toUpperCase()+s.status.slice(1)})]}),e.jsx("button",{onClick:p,className:"p-2 hover:bg-gray-100 rounded-lg transition-colors duration-200",children:e.jsx(A,{className:"w-6 h-6 text-gray-500"})})]}),e.jsxs("div",{className:"px-6 py-6 space-y-6",children:[e.jsxs("section",{children:[e.jsxs("h3",{className:"text-lg font-semibold text-gray-900 mb-4 flex items-center space-x-2",children:[e.jsx(D,{className:"w-5 h-5 text-blue-600"}),e.jsx("span",{children:"Company Information"})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-start",children:[e.jsx(L,{className:"w-5 h-5 text-gray-400 mt-0.5 mr-3"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-500",children:"Website"}),e.jsx("a",{href:s.company_website,target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 hover:text-blue-800 font-medium",children:s.company_website})]})]}),e.jsxs("div",{className:"flex items-start",children:[e.jsx(D,{className:"w-5 h-5 text-gray-400 mt-0.5 mr-3"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-500",children:"Industry"}),e.jsx("p",{className:"font-medium text-gray-900",children:s.industry})]})]}),e.jsxs("div",{className:"flex items-start",children:[e.jsx($,{className:"w-5 h-5 text-gray-400 mt-0.5 mr-3"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-500",children:"Company Size"}),e.jsx("p",{className:"font-medium text-gray-900",children:s.company_size})]})]}),e.jsxs("div",{className:"flex items-start",children:[e.jsx(ne,{className:"w-5 h-5 text-gray-400 mt-0.5 mr-3"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-500 mb-1",children:"Email Domains"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:s.email_domains.map((r,l)=>e.jsxs("span",{className:"px-3 py-1 bg-blue-100 text-blue-800 rounded-full text-sm font-medium",children:["@",r]},l))})]})]})]})]}),s.description&&e.jsxs("section",{children:[e.jsxs("h3",{className:"text-lg font-semibold text-gray-900 mb-3 flex items-center space-x-2",children:[e.jsx(O,{className:"w-5 h-5 text-blue-600"}),e.jsx("span",{children:"Description"})]}),e.jsx("p",{className:"text-gray-700 bg-gray-50 p-4 rounded-lg",children:s.description})]}),s.justification&&e.jsxs("section",{children:[e.jsxs("h3",{className:"text-lg font-semibold text-gray-900 mb-3 flex items-center space-x-2",children:[e.jsx(ie,{className:"w-5 h-5 text-blue-600"}),e.jsx("span",{children:"Justification"})]}),e.jsx("p",{className:"text-gray-700 bg-blue-50 p-4 rounded-lg border border-blue-200",children:s.justification})]}),e.jsxs("section",{children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-3",children:"Request Details"}),e.jsxs("div",{className:"bg-gray-50 rounded-lg p-4 space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"Request ID"}),e.jsxs("span",{className:"text-sm font-mono text-gray-900",children:[s.id.slice(0,8),"..."]})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"Submitted"}),e.jsx("span",{className:"text-sm text-gray-900",children:h(s.created_at)})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"Requester Hash"}),e.jsxs("span",{className:"text-sm font-mono text-gray-900",children:[s.requester_hash.slice(0,16),"..."]})]})]})]}),s.status!=="pending"&&e.jsxs("section",{children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-3",children:"Review Information"}),e.jsxs("div",{className:"bg-gray-50 rounded-lg p-4 space-y-2",children:[s.reviewed_at&&e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"Reviewed At"}),e.jsx("span",{className:"text-sm text-gray-900",children:h(s.reviewed_at)})]}),s.reviewed_by&&e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"Reviewed By"}),e.jsx("span",{className:"text-sm text-gray-900",children:s.reviewed_by})]}),s.admin_notes&&e.jsxs("div",{className:"pt-2 border-t border-gray-200",children:[e.jsx("p",{className:"text-sm text-gray-600 mb-1",children:"Admin Notes"}),e.jsx("p",{className:"text-sm text-gray-900",children:s.admin_notes})]}),s.rejection_reason&&e.jsxs("div",{className:"pt-2 border-t border-gray-200",children:[e.jsx("p",{className:"text-sm text-gray-600 mb-1",children:"Rejection Reason"}),e.jsx("p",{className:"text-sm text-red-700 bg-red-50 p-3 rounded",children:s.rejection_reason})]})]})]})]}),e.jsx("div",{className:"sticky bottom-0 bg-gray-50 border-t border-gray-200 px-6 py-4 flex justify-end",children:e.jsx("button",{onClick:p,className:"px-6 py-2 bg-gray-200 text-gray-800 rounded-lg hover:bg-gray-300 transition-colors duration-200 font-medium",children:"Close"})})]})})},ue=({request:s,isOpen:n,onClose:p,onConfirm:h})=>{const[c,r]=i.useState(""),[l,g]=i.useState(!1),[m,o]=i.useState(null),[b,u]=i.useState(!1),[t,j]=i.useState(null),C=[{value:"1-50 employees",label:"Startup/Small (1-50 employees)"},{value:"51-200 employees",label:"Medium (51-200 employees)"},{value:"201-1000 employees",label:"Large (201-1000 employees)"},{value:"1000+ employees",label:"Enterprise (1000+ employees)"}];if(i.useEffect(()=>{s&&n&&j({company_name:s.company_name,company_website:s.company_website,email_domains:s.email_domains,industry:s.industry,company_size:s.company_size})},[s,n]),!n||!s||!t)return null;const N=async()=>{o(null),g(!0);try{const d=t.company_name!==s.company_name||t.company_website!==s.company_website||t.industry!==s.industry||t.company_size!==s.company_size||JSON.stringify(t.email_domains)!==JSON.stringify(s.email_domains);await h(s.id,c.trim()||void 0,d?t:void 0),r(""),u(!1),p()}catch(d){o(d instanceof Error?d.message:"Failed to approve request")}finally{g(!1)}},x=()=>{l||(r(""),o(null),u(!1),p())},_=t.company_name!==s.company_name||t.company_website!==s.company_website||t.industry!==s.industry||t.company_size!==s.company_size||JSON.stringify(t.email_domains)!==JSON.stringify(s.email_domains);return e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-4",children:e.jsxs("div",{className:"bg-white rounded-lg max-w-lg w-full",children:[e.jsxs("div",{className:"border-b border-gray-200 px-6 py-4 flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"w-10 h-10 bg-green-100 rounded-full flex items-center justify-center",children:e.jsx(S,{className:"w-6 h-6 text-green-600"})}),e.jsx("h2",{className:"text-xl font-bold text-gray-900",children:"Approve Company Request"})]}),e.jsx("button",{onClick:x,disabled:l,className:"p-2 hover:bg-gray-100 rounded-lg transition-colors duration-200 disabled:opacity-50",children:e.jsx(A,{className:"w-5 h-5 text-gray-500"})})]}),e.jsxs("div",{className:"px-6 py-6",children:[m&&e.jsxs("div",{className:"mb-4 p-4 bg-red-50 border border-red-200 rounded-lg flex items-start space-x-3",children:[e.jsx(T,{className:"w-5 h-5 text-red-600 mt-0.5 flex-shrink-0"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-red-800",children:"Error"}),e.jsx("p",{className:"text-sm text-red-700",children:m})]})]}),e.jsxs("div",{className:"mb-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("p",{className:"text-gray-700",children:b?"Edit company details before approval:":"You are about to approve the request to add:"}),e.jsxs("button",{onClick:()=>u(!b),disabled:l,className:"flex items-center space-x-1 text-sm text-blue-600 hover:text-blue-700 font-medium disabled:opacity-50",children:[e.jsx(oe,{className:"w-4 h-4"}),e.jsx("span",{children:b?"Cancel Edit":"Edit Details"})]})]}),b?e.jsxs("div",{className:"space-y-4 bg-gray-50 border border-gray-200 rounded-lg p-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Company Name"}),e.jsx("input",{type:"text",value:t.company_name,onChange:d=>j({...t,company_name:d.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",disabled:l})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Company Website"}),e.jsx("input",{type:"url",value:t.company_website,onChange:d=>j({...t,company_website:d.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",disabled:l})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Industry"}),e.jsx(me,{value:t.industry,onChange:d=>j({...t,industry:d})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Company Size"}),e.jsx("select",{value:t.company_size,onChange:d=>j({...t,company_size:d.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",disabled:l,children:C.map(d=>e.jsx("option",{value:d.value,children:d.label},d.value))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Email Domains"}),e.jsx(xe,{domains:t.email_domains,onChange:d=>j({...t,email_domains:d})})]})]}):e.jsxs("div",{className:`border rounded-lg p-4 ${_?"bg-yellow-50 border-yellow-300":"bg-blue-50 border-blue-200"}`,children:[_&&e.jsxs("div",{className:"mb-2 flex items-center space-x-2 text-yellow-800",children:[e.jsx(T,{className:"w-4 h-4"}),e.jsx("p",{className:"text-sm font-medium",children:"Modified from original request"})]}),e.jsx("p",{className:"font-bold text-gray-900 text-lg mb-1",children:t.company_name}),e.jsx("p",{className:"text-sm text-gray-600",children:t.company_website}),e.jsxs("p",{className:"text-sm text-gray-600 mt-1",children:[t.industry," • ",t.company_size]}),t.email_domains.length>0&&e.jsxs("p",{className:"text-sm text-gray-600 mt-1",children:["Email domains: ",t.email_domains.join(", ")]})]})]}),e.jsxs("div",{className:"mb-4 p-4 bg-green-50 border border-green-200 rounded-lg",children:[e.jsx("p",{className:"text-sm font-medium text-green-800 mb-2",children:"What will happen:"}),e.jsxs("ul",{className:"text-sm text-green-700 space-y-1 list-disc list-inside",children:[e.jsx("li",{children:"Company will be added to the database"}),e.jsx("li",{children:"Request status will be marked as approved"}),e.jsx("li",{children:"Requester will receive an approval email"}),e.jsx("li",{children:"Requester can write their review"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Admin Notes (Optional)"}),e.jsx("textarea",{value:c,onChange:d=>r(d.target.value),placeholder:"Add any internal notes about this approval...",className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent resize-none",rows:3,maxLength:500,disabled:l}),e.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:[c.length,"/500 characters"]})]})]}),e.jsxs("div",{className:"bg-gray-50 border-t border-gray-200 px-6 py-4 flex items-center justify-end space-x-3",children:[e.jsx("button",{onClick:x,disabled:l,className:"px-6 py-2 border border-gray-300 rounded-lg text-gray-700 hover:bg-gray-100 transition-colors duration-200 font-medium disabled:opacity-50",children:"Cancel"}),e.jsx("button",{onClick:N,disabled:l,className:"px-6 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors duration-200 font-medium flex items-center space-x-2 disabled:opacity-50",children:l?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin"}),e.jsx("span",{children:"Approving..."})]}):e.jsxs(e.Fragment,{children:[e.jsx(S,{className:"w-4 h-4"}),e.jsx("span",{children:"Confirm Approval"})]})})]})]})})},ye=({request:s,isOpen:n,onClose:p,onConfirm:h})=>{const[c,r]=i.useState(""),[l,g]=i.useState(""),[m,o]=i.useState(!1),[b,u]=i.useState(null),t=["Company already exists in database","Insufficient information provided","Not a valid company","Duplicate request","Unable to verify company legitimacy"];if(!n||!s)return null;const j=async()=>{if(!c.trim()){u("Rejection reason is required");return}if(c.trim().length<20){u("Rejection reason must be at least 20 characters");return}u(null),o(!0);try{await h(s.id,c.trim(),l.trim()||void 0),r(""),g(""),p()}catch(x){u(x instanceof Error?x.message:"Failed to reject request")}finally{o(!1)}},C=()=>{m||(r(""),g(""),u(null),p())},N=x=>{r(x),u(null)};return e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-4",children:e.jsxs("div",{className:"bg-white rounded-lg max-w-lg w-full max-h-[90vh] overflow-y-auto",children:[e.jsxs("div",{className:"sticky top-0 bg-white border-b border-gray-200 px-6 py-4 flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"w-10 h-10 bg-red-100 rounded-full flex items-center justify-center",children:e.jsx(k,{className:"w-6 h-6 text-red-600"})}),e.jsx("h2",{className:"text-xl font-bold text-gray-900",children:"Reject Company Request"})]}),e.jsx("button",{onClick:C,disabled:m,className:"p-2 hover:bg-gray-100 rounded-lg transition-colors duration-200 disabled:opacity-50",children:e.jsx(A,{className:"w-5 h-5 text-gray-500"})})]}),e.jsxs("div",{className:"px-6 py-6",children:[b&&e.jsxs("div",{className:"mb-4 p-4 bg-red-50 border border-red-200 rounded-lg flex items-start space-x-3",children:[e.jsx(T,{className:"w-5 h-5 text-red-600 mt-0.5 flex-shrink-0"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-red-800",children:"Error"}),e.jsx("p",{className:"text-sm text-red-700",children:b})]})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("p",{className:"text-gray-700 mb-2",children:"You are about to reject the request to add:"}),e.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4",children:[e.jsx("p",{className:"font-bold text-gray-900 text-lg mb-1",children:s.company_name}),e.jsx("p",{className:"text-sm text-gray-600",children:s.company_website}),e.jsxs("p",{className:"text-sm text-gray-600 mt-1",children:[s.industry," • ",s.company_size]})]})]}),e.jsxs("div",{className:"mb-4 p-4 bg-yellow-50 border border-yellow-200 rounded-lg",children:[e.jsx("p",{className:"text-sm font-medium text-yellow-800 mb-2",children:"What will happen:"}),e.jsxs("ul",{className:"text-sm text-yellow-700 space-y-1 list-disc list-inside",children:[e.jsx("li",{children:"Company will NOT be added to the database"}),e.jsx("li",{children:"Request status will be marked as rejected"}),e.jsx("li",{children:"Requester will receive a rejection email with your reason"})]})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Quick Select Common Reasons"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:t.map((x,_)=>e.jsx("button",{onClick:()=>N(x),disabled:m,className:`px-3 py-1.5 rounded-lg text-sm font-medium transition-colors duration-200 ${c===x?"bg-red-600 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"} disabled:opacity-50`,children:x},_))})]}),e.jsxs("div",{className:"mb-4",children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Rejection Reason ",e.jsx("span",{className:"text-red-600",children:"*"})]}),e.jsx("textarea",{value:c,onChange:x=>{r(x.target.value),u(null)},placeholder:"Explain why this request is being rejected. This will be sent to the requester.",className:`w-full px-4 py-2 border rounded-lg focus:ring-2 focus:ring-red-500 focus:border-transparent resize-none ${b?"border-red-300":"border-gray-300"}`,rows:4,maxLength:1e3,disabled:m}),e.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:[c.length,"/1000 characters (minimum 20 required)"]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Admin Notes (Optional)"}),e.jsx("textarea",{value:l,onChange:x=>g(x.target.value),placeholder:"Add any internal notes about this rejection (not sent to requester)...",className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-red-500 focus:border-transparent resize-none",rows:2,maxLength:500,disabled:m}),e.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:[l.length,"/500 characters"]})]})]}),e.jsxs("div",{className:"sticky bottom-0 bg-gray-50 border-t border-gray-200 px-6 py-4 flex items-center justify-end space-x-3",children:[e.jsx("button",{onClick:C,disabled:m,className:"px-6 py-2 border border-gray-300 rounded-lg text-gray-700 hover:bg-gray-100 transition-colors duration-200 font-medium disabled:opacity-50",children:"Cancel"}),e.jsx("button",{onClick:j,disabled:m,className:"px-6 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 transition-colors duration-200 font-medium flex items-center space-x-2 disabled:opacity-50",children:m?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin"}),e.jsx("span",{children:"Rejecting..."})]}):e.jsxs(e.Fragment,{children:[e.jsx(k,{className:"w-4 h-4"}),e.jsx("span",{children:"Confirm Rejection"})]})})]})]})})},Re=()=>{const s=i.useContext(Q),[n,p]=i.useState([]),[h,c]=i.useState([]),[r,l]=i.useState(!0),[g,m]=i.useState(!1),[o,b]=i.useState("all"),[u,t]=i.useState("all"),[j,C]=i.useState(""),[N,x]=i.useState(null),[_,d]=i.useState(!1),[J,z]=i.useState(!1),[P,F]=i.useState(!1);i.useEffect(()=>{E()},[]),i.useEffect(()=>{B()},[n,o,u,j]);const E=async()=>{try{const a=await M();p(a)}catch(a){console.error("Error fetching requests:",a),s==null||s.addToast("Failed to load company requests","error")}finally{l(!1)}},U=async()=>{m(!0);try{const a=await M();p(a),s==null||s.addToast("Requests refreshed","success")}catch(a){console.error("Error refreshing requests:",a),s==null||s.addToast("Failed to refresh requests","error")}finally{m(!1)}},B=()=>{let a=[...n];if(o!=="all"&&(a=a.filter(y=>y.status===o)),u!=="all"&&(a=a.filter(y=>y.industry===u)),j.trim()){const y=j.toLowerCase();a=a.filter(f=>f.company_name.toLowerCase().includes(y)||f.company_website.toLowerCase().includes(y))}c(a)},W=()=>{const a=new Set(n.map(y=>y.industry));return Array.from(a).sort()},H=()=>{const a=n.filter(w=>w.status==="pending").length,y=n.filter(w=>w.status==="rejected").length,f=new Date;f.setHours(0,0,0,0);const v=n.filter(w=>{if(w.status!=="approved"||!w.reviewed_at)return!1;const I=new Date(w.reviewed_at);return I.setHours(0,0,0,0),I.getTime()===f.getTime()}).length;return{pending:a,approvedToday:v,rejected:y,total:n.length}},V=a=>{x(a),d(!0)},Y=a=>{x(a),z(!0)},G=a=>{x(a),F(!0)},X=async(a,y,f)=>{try{await q(a,y,f),s==null||s.addToast("Company request approved successfully","success"),await E()}catch(v){throw console.error("Error approving request:",v),v}},K=async(a,y,f)=>{try{await ee(a,y,f),s==null||s.addToast("Company request rejected","success"),await E()}catch(v){throw console.error("Error rejecting request:",v),v}},R=H();return e.jsxs(Z,{children:[e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 to-green-50",children:e.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between mb-6",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900 mb-2",children:"Company Requests"}),e.jsx("p",{className:"text-gray-600",children:"Review and manage company addition requests"})]}),e.jsxs("button",{onClick:U,disabled:g,className:"mt-4 sm:mt-0 flex items-center space-x-2 px-4 py-2 bg-white border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors duration-200 disabled:opacity-50",children:[e.jsx(de,{className:`w-4 h-4 ${g?"animate-spin":""}`}),e.jsx("span",{children:"Refresh"})]})]}),e.jsx(pe,{pendingCount:R.pending,approvedToday:R.approvedToday,rejectedCount:R.rejected,totalCount:R.total}),e.jsx(he,{statusFilter:o,setStatusFilter:b,industryFilter:u,setIndustryFilter:t,searchQuery:j,setSearchQuery:C,industries:W()}),r&&e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsxs("div",{className:"flex flex-col items-center space-y-4",children:[e.jsx("div",{className:"w-12 h-12 border-4 border-blue-600 border-t-transparent rounded-full animate-spin"}),e.jsx("p",{className:"text-gray-600",children:"Loading requests..."})]})}),!r&&e.jsx(e.Fragment,{children:h.length===0?e.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-12 text-center",children:[e.jsx(ce,{className:"w-16 h-16 text-gray-400 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"No requests found"}),e.jsx("p",{className:"text-gray-600",children:n.length===0?"No company requests have been submitted yet.":"No requests match your current filters."})]}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"mb-4 flex items-center justify-between",children:e.jsxs("p",{className:"text-sm text-gray-600",children:["Showing ",h.length," of ",n.length," request",n.length!==1?"s":""]})}),e.jsx("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:h.map(a=>e.jsx(ge,{request:a,onViewDetails:V,onApprove:Y,onReject:G},a.id))})]})})]})}),e.jsx(be,{request:N,isOpen:_,onClose:()=>d(!1)}),e.jsx(ue,{request:N,isOpen:J,onClose:()=>z(!1),onConfirm:X}),e.jsx(ye,{request:N,isOpen:P,onClose:()=>F(!1),onConfirm:K})]})};export{Re as default};
